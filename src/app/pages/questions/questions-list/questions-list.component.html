<div class="container questions-container">
  <div class="questions-header">
    <div class="row align-items-center">
      <div class="col">
        <h1>All Questions</h1>
      </div>
      <div class="col-auto">
        <button
          pButton
          type="button"
          label="Ask Question"
          icon="pi pi-plus"
          class="p-button-primary"
          (click)="askQuestion()"
        ></button>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col">
        <p>{{ questions.length }} questions</p>
      </div>
      <div class="col-auto">
        <p-dropdown
          [options]="[
            { label: 'Newest', value: 'newest' },
            { label: 'Active', value: 'active' },
            { label: 'Votes', value: 'votes' },
            { label: 'Unanswered', value: 'unanswered' }
          ]"
          optionLabel="label"
          placeholder="Sort by"
          styleClass="sort-dropdown"
        ></p-dropdown>
      </div>
    </div>
  </div>

  <p-divider></p-divider>

  <div class="questions-list">
    <p-skeleton
      *ngIf="loading"
      width="100%"
      height="150px"
      styleClass="mb-4"
      [style]="{ 'margin-bottom': '1rem' }"
    ></p-skeleton>
    <p-skeleton
      *ngIf="loading"
      width="100%"
      height="150px"
      styleClass="mb-4"
      [style]="{ 'margin-bottom': '1rem' }"
    ></p-skeleton>
    <p-skeleton
      *ngIf="loading"
      width="100%"
      height="150px"
      styleClass="mb-4"
      [style]="{ 'margin-bottom': '1rem' }"
    ></p-skeleton>

    <div *ngIf="!loading">
      <div class="question-item" *ngFor="let question of questions">
        <div class="row">
          <div class="col-md-10 col-sm-9 content-container">
            <h2 class="question-title">
              <a (click)="viewQuestion(question.id)" class="title-link">{{
                question.title
              }}</a>
            </h2>
            <p class="question-excerpt">
              {{ question.body | slice : 0 : 150
              }}{{ question.body.length > 150 ? "..." : "" }}
            </p>
            <div class="question-meta">
              <div class="tags">
                <span *ngFor="let tag of question.tags" class="tag">{{
                  tag
                }}</span>
              </div>
              <div class="user-info">
                <span class="asked-by">{{ question.askedBy }}</span>
                <span class="asked-date"
                  >asked {{ question.askedDate | date : "mediumDate" }}</span
                >
              </div>
            </div>
          </div>
          <div class="col-md-2 col-sm-3 stats-container">
            <div class="stats">
              <div class="votes">
                <span class="count">{{ question.votes }}</span>
                <span class="label">votes</span>
              </div>
              <div
                class="answers"
                [ngClass]="{ 'has-answers': question.answers > 0 }"
              >
                <span class="count">{{ question.answers }}</span>
                <span class="label">answers</span>
              </div>
            </div>
          </div>
        </div>
        <p-divider></p-divider>
      </div>
    </div>

    <div *ngIf="!loading && questions.length === 0" class="no-questions">
      <p>No questions found. Be the first to ask a question!</p>
      <button
        pButton
        type="button"
        label="Ask Question"
        icon="pi pi-plus"
        class="p-button-primary"
        (click)="askQuestion()"
      ></button>
    </div>
  </div>

  <div *ngIf="!loading && questions.length > 0" class="pagination-container">
    <p-paginator
      [rows]="10"
      [totalRecords]="50"
      [rowsPerPageOptions]="[5, 10, 20]"
    ></p-paginator>
  </div>
</div>
